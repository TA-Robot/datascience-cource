# 1.1.6 極限定理

確率論における**極限定理**(limit theorem)は、独立または適度な依存性をもつ確率変数の集まりが無限に増えたときに、どのような極限挙動を示すかを教えてくれる理論体系です。統計学や機械学習の多くの手法は、この極限定理を基礎にして設計されています。ここでは代表的な極限定理を系統立てて学び、実際にどのような応用があるのかを詳しく見ていきます。

---

## 1. 大数の法則

大数の法則 (law of large numbers) は、たくさんの独立同分布の確率変数を平均すると真の平均に近づく、という直感的事実を数学的に保証するものです。サンプルサイズを増やすと平均が安定するという経験則はこの定理に支えられています。

### 1.1 弱法則

同一分布の独立確率変数 $(X_i)_{i=1}^n$ を考えます。平均 $\mu=E[X_i]$ が有限であるとき、

```math
\frac{1}{n}\sum_{i=1}^n X_i \xrightarrow{P} \mu.
```

つまり平均値の列は確率収束によって真の平均 $\mu$ に近づきます。この結果は**弱法則**と呼ばれ、マルコフの不等式やチェビシェフの不等式を用いて証明されます。

### 1.2 強法則

さらに条件を強めると、ほとんど確実に収束することも示せます。

```math
\frac{1}{n}\sum_{i=1}^n X_i \xrightarrow{\text{a.s.}} \mu.
```

これを**強法則**と呼びます。コルモゴロフの三系列定理やBorel–Cantelli補題を駆使するのが標準的な証明方法です。実務では「平均はいつか必ず真値に近づく」という確信を与えてくれる定理として理解するとよいでしょう。

### 1.3 Khintchineの強法則

クラシックな強法則よりも弱い条件で成り立つ一般化版です。平均が存在するだけでよく、分散やそれ以上のモーメントを仮定しません。独立かつ同分布でなくとも適用できるため、統計的推定の理論基盤を広げてくれます。

### 1.4 その他の拡張

大数の法則には多くの拡張があります。たとえば

- **Kolmogorovの不等式**: 部分和の最大値を評価し収束速度を定量化する
- **Etemadiの強法則**: 独立性が弱い場合でも成り立つ強法則
- **マルチンゲール型大数の法則**: マルチンゲール条件下でのサンプル平均の収束を扱う

これらは確率過程や時系列解析で重要な役割を果たします。

### 1.5 実用的な視点

- サンプル平均が母平均に収束する性質は統計的推定や品質管理の根拠となる
- シミュレーションの分野では試行回数を増やせば推定誤差が減ることを保証する
- 金融工学や物理学のモンテカルロ法では、試行回数を増やすほど期待値計算の精度が上がる

実際の応用では計算コストやデータ取得コストとの兼ね合いで、どの程度サンプルを増やせばよいかが議論されます。

---
## 2. 中心極限定理

確率論でもっとも有名な結果の一つが中心極限定理 (central limit theorem; CLT) です。独立確率変数の和が大きくなるとき、適切に正規化するとその分布は正規分布へ近づきます。これは「平均値はほぼ正規分布に従う」という経験則を数学的に正当化するものです。

### 2.1 基本形

独立同分布 $X_i$ で平均 $\mu$、分散 $\sigma^2$ が有限であるとき、

```math
\frac{\sum_{i=1}^n (X_i-\mu)}{\sqrt{n\sigma^2}} \xrightarrow{d} \mathcal{N}(0,1).
```

ここで $\xrightarrow{d}$ は分布収束を意味します。直感的には標本平均のばらつきが $\mathcal{N}(\mu, \sigma^2/n)$ に近づくということです。

### 2.2 Lyapunovの条件

分散より高次のモーメントが存在する場合、リャプノフの定理により中心極限定理が成立します。条件式は

```math
\lim_{n\to\infty} \frac{1}{s_n^{2+r}} \sum_{i=1}^n E\bigl[|X_i-\mu|^{2+r}\bigr] = 0,
```

ここで $s_n^2 = \sum_{i=1}^n \operatorname{Var}(X_i)$、$r>0$ は定数です。この条件が満たされると、部分和は正規分布に近づきます。

### 2.3 Lindebergの条件

より弱い条件としてLindeberg条件があります。任意の $\varepsilon>0$ に対し

```math
\lim_{n\to\infty} \frac{1}{s_n^2} \sum_{i=1}^n E\bigl[(X_i-\mu)^2; |X_i-\mu| > \varepsilon s_n\bigr] = 0.
```

この条件のもとでも中心極限定理は成立し、異なる分布を組み合わせた和にも適用できます。Lindeberg条件は「大きな跳び」の影響を無視できることを意味します。

### 2.4 Berry–Esseenの評価

中心極限定理による正規近似の誤差を具体的に評価するのがBerry–Esseenの定理です。第三モーメントが有限であるとき、

```math
\sup_x \bigl|P\bigl(S_n \le x\bigr) - \Phi(x)\bigr| \le \frac{C\rho}{\sigma^3\sqrt{n}},
```

ここで $S_n$ は標準化された和、$\Phi$ は標準正規分布、$\rho$ は第三絶対中心モーメント、$C$ は普遍定数です。収束速度が $1/\sqrt{n}$ であることがわかり、実務でのサンプルサイズの判断材料となります。

### 2.5 ポアソン近似

成功確率が小さい二項分布を近似する際に有効なのがポアソン近似です。試行回数 $n$、成功確率 $p$ で $np=\lambda$ を固定するとき、

```math
\operatorname{Bin}(n,p) \approx \operatorname{Poi}(\lambda).
```

確率母関数の極限を取ることで導かれ、希な事象の出現回数を数えるモデルで広く用いられます。

### 2.6 正規近似

二項分布の成功確率 $p$ が一定で $n$ が大きいときは正規近似が適しています。中心極限定理を利用すると

```math
\operatorname{Bin}(n,p) \approx \mathcal{N}(np, np(1-p)).
```

と近似できます。連続性補正を導入することで、離散分布と連続分布の違いによる誤差を小さくできます。

### 2.7 局所極限定理

中心極限定理の「確率質量関数版」ともいえる局所極限定理では、離散分布の確率値そのものが正規分布の密度に近づくことを扱います。二項分布やポアソン分布に対して、より細かい近似が可能になるため、数え上げ問題や組合せ論的な応用で重要です。

### 2.8 多次元版

ベクトル値確率変数の場合にも中心極限定理は成立します。共分散行列で正規化したベクトル和が多次元正規分布へ収束し、統計的推定の多変量版（t検定やMANOVAなど）の理論的基盤となります。

### 2.9 実例：サンプル平均の分布

統計学では標本平均の分布がほぼ正規であるという事実を頻繁に利用します。たとえば信頼区間の計算、仮説検定の構築、標準誤差の評価などです。中心極限定理により、サンプルサイズさえ十分ならば母分布の形状にかかわらず近似計算が可能となります。

### 2.10 シミュレーションの視点

コンピュータ上で疑似乱数を生成し平均や和をとったときに正規分布へ近づく様子を観察すると、中心極限定理を体感できます。Monte Carlo法の収束解析や分布生成アルゴリズムの検証には欠かせない考え方です。

---
## 3. 安定分布と拡張された極限定理

中心極限定理は分散が有限である場合を扱いますが、分散が無限大になる重い裾をもつ分布では異なる極限が現れます。その代表例が**安定分布 (stable distribution)** です。

### 3.1 α-stable分布の特徴

- 分散が定義されない場合でも極限分布になりうる
- 位置パラメータとスケールパラメータに加え、指数 $\alpha$ と歪度パラメータ $\beta$ をもつ
- $\alpha=2$ のときは正規分布に一致し、$\alpha<2$ では裾が重い
- 形状は多様だが閉形式の密度を持たないことが多い
- 金融リスクや通信量モデリングに応用される

### 3.2 一般化された中心極限定理

独立同分布の確率変数列で分散が無限大の場合、適切な正規化のもとで安定分布へ収束することがあります。これを**一般化された中心極限定理**と呼び、クラシカルな正規分布の枠を超えた極限理論を提供します。

### 3.3 ドメイン・オブ・アトラクション

どのような分布がどの安定分布へ収束するかを調べる研究分野です。パレート分布やレヴィ分布など、裾の指数がある範囲に入るときに特定の安定分布が極限として現れます。条件を満たすかどうかは分布の尾の振る舞いによって決まります。

### 3.4 ランダムウォークへの応用

分散が大きい、あるいは無限大のステップをもつランダムウォークは通常の正規極限ではなく、レヴィ過程に近づきます。こうしたモデルは金融商品の価格変動やインターネットトラフィックのように、稀に非常に大きな変動が起こる現象を説明する際に使われます。

### 3.5 実務上の注意点

- 安定分布はパラメータ推定が難しく、数値計算にも工夫が必要
- データの裾が重いかどうかを判別する統計的検定が重要
- モンテカルロ法でもサンプルサイズに対する分散の見積もりが不安定になりやすい

---
## 4. 極限定理の応用例

極限定理の理解は、応用統計や機械学習のさまざまな場面で役立ちます。以下では代表的な分野をいくつか紹介します。

### 4.1 モンテカルロ法とシミュレーション

乱数を大量に発生させて数値積分や期待値計算を行うモンテカルロ法では、大数の法則と中心極限定理が理論的な裏付けとなります。試行回数を増やすほど推定精度が向上し、誤差の分布が正規に近づくため、信頼区間の評価も可能になります。

### 4.2 統計的推定

推定量の漸近分布を調べるとき、中心極限定理は欠かせません。特に最尤推定量やモーメント法による推定量は、適切な条件下で正規分布に近づくことが知られています。これにより大規模データに対する近似的な検定や区間推定が実現します。

### 4.3 ベイズ推論

事後分布の近似計算（Laplace近似や変分法）でも、中心極限定理に基づいた正規近似がしばしば利用されます。マルコフ連鎖モンテカルロ法 (MCMC) の収束診断にも、大数の法則と中心極限定理の考え方が応用されます。

### 4.4 機械学習

統計的学習理論では、損失関数の期待値最小化や汎化誤差の解析に極限定理が登場します。勾配法による最適化の安定性評価や、アンサンブル学習の効果分析にも役立ちます。

### 4.5 信号処理と情報理論

ノイズが多い環境で信号を扱うとき、ノイズの和はしばしば正規分布に近似されます。これは通信路容量の計算やフィルタリングアルゴリズムの理論背景に直結します。レーダー信号や医用画像のノイズモデリングにも中心極限定理が利用されます。

### 4.6 金融工学

資産価格モデルやリスク管理では、極端な値動きを予測するために安定分布やポアソン近似が使われます。特に高頻度取引データでは重い裾を持つモデルを採用することが多く、一般化された中心極限定理の知識が必要です。

### 4.7 時系列解析

自己相関をもつデータでは独立性が成り立たないため、大数の法則や中心極限定理の適用条件が変化します。弱依存性やミキシング条件を導入することで漸近的な正規性を保証する結果があります。ARMAモデルやGARCHモデルの推定理論もこうした発展型の極限定理に支えられています。

### 4.8 大規模データと分散計算

現代のデータ解析では膨大なデータを扱うことが一般的です。分散計算環境で部分集計を行い、最終的に平均を取るときなども大数の法則が信頼性の根拠になります。マシンラーニングフレームワークでのバッチ学習やオンライン学習でも、サンプルサイズが増えるにつれて安定した結果が得られる理由を極限定理が説明してくれます。

### 4.9 深層学習との関係

ディープラーニングでは膨大なパラメータを持つネットワークが用いられます。重みの初期化や活性化関数の選択では、層を深くしたときに出力の分散がどのように変化するかを分析する際、中心極限定理が近似的に利用されます。また、幅広い隠れ層を持つネットワークの挙動がガウス過程に近づくという理論も極限定理の延長線上に位置づけられます。

### 4.10 ネットワーク科学

巨大なグラフやネットワークの性質を統計的に調べる際にも極限定理が活躍します。ノードの次数分布やクラスター係数の平均などを大量のサンプルから推定するとき、サンプル平均の漸近挙動を知ることで信頼度の高い結論を導けます。

---

## 5. まとめ

極限定理は確率論を学ぶ上で欠かせない柱であり、サンプルサイズが増加したときの振る舞いを定式化してくれます。大数の法則は平均の安定性を保証し、中心極限定理は分布の形状を正規分布へと近づけます。さらに安定分布やポアソン近似、局所極限定理といった拡張は、より複雑な状況下での近似を可能にします。

現代のデータサイエンスでは、これらの極限定理を踏まえたうえで統計手法や機械学習アルゴリズムが設計されています。理論を理解することで、シミュレーション結果の信頼性や推定値の精度を評価する際に確固とした根拠を持つことができます。ぜひ実データを通じて極限定理の働きを確認し、より深い洞察を得てください。
### 1.6 具体例：サイコロの平均

最も単純な例として、1から6までの目をもつ公平なサイコロを投げる実験を考えます。各試行で得られる値を $X_i$ とすると平均は $E[X_i]=3.5$ です。大数の法則によれば、サイコロを $n$ 回振って得られる平均値

```math
\overline{X}_n = \frac{1}{n}\sum_{i=1}^n X_i
```

は $n$ を大きくするにつれて 3.5 に収束します。実際にコンピュータでシミュレーションすると、数百回程度でかなり安定した値が得られることが分かります。

### 1.7 マルチンゲール版大数の法則

確率変数列がマルチンゲールとなっている場合にも、一定の条件下でサンプル平均が収束することが知られています。これは金融モデルにおける価格過程の解析などで重要な役割を果たします。

---
### 2.11 Edgeworth展開

中心極限定理のより精密な近似として、Edgeworth展開があります。これは正規分布への収束過程を漸近的な級数として表現するもので、高次のモーメントを用いることで近似精度を向上させます。実際には

```math
P\bigl(S_n \le x\bigr) \approx \Phi(x) + \frac{\kappa_3}{6\sqrt{n}}(x^2-1)\phi(x) + \cdots
```

のように展開されます。ここで $\kappa_3$ は三次の標準化モーメント、$\phi$ は標準正規密度です。

### 2.12 ランダムウォークの例

独立なステップの和として表されるランダムウォークは、中心極限定理の典型例です。ステップの分布に依存せず、適切にスケールすればガウス過程へ収束します。金融の株価モデルや物理の粒子拡散モデルで重要です。

### 2.13 数値実験のすすめ

PythonやRで乱数を発生させ、サンプル平均や部分和のヒストグラムを描くと、中心極限定理が視覚的に確認できます。学習者にとって、理論と実験を結びつける格好の題材となります。

---
### 3.6 レヴィ過程との関連

安定分布を極限に持つ確率過程としてはレヴィ過程が有名です。レヴィ過程は独立増分と定常増分をもつ確率過程で、ポアソン過程やブラウン運動、α-stable過程などを含む広いクラスを指します。極限定理の観点からは、ランダムウォークのスケーリング極限としてレヴィ過程が現れる点が重要です。

### 3.7 自己相似過程

安定分布は自己相似性をもつ過程との相性が良く、トラフィックデータや地震の発生間隔などに応用されます。自己相似性をもつデータでは、通常の分散評価が難しいため、安定分布に基づくモデリングが実務上有効な場合があります。

---
### 4.11 統計教育への応用

極限定理は統計学教育の中心的トピックであり、具体的な数値例やシミュレーション演習を通じて直観を養うことが推奨されます。特に中心極限定理は、統計的推測の理論的背景として学生に理解してもらうべき内容です。

### 4.12 研究分野での発展

極限定理は現在も研究が盛んな分野であり、依存性のあるデータへの拡張や、より高速な収束評価、量子確率論への応用など、さまざまな方向で発展が続いています。実データを通じて理論を検証するスタンスは今後も重要視されるでしょう。

---
### 2.14 まとめと補足

中心極限定理は確率論の強力なツールであり、実務では「サンプル平均はほぼ正規分布に従う」という単純な形で使われます。しかし正規近似の精度や適用条件を理解しておくことは、統計解析の信頼性を高めるうえで欠かせません。Berry–Esseenの評価やEdgeworth展開などを併用することで、より厳密な誤差評価が可能となります。

### 3.8 数理ファイナンスでの利用

安定分布や一般化された中心極限定理は、金融市場のリターンが正規分布に従わないことを説明する理論的枠組みとして使われます。特に極端な価格変動をモデル化する際には、α-stable分布やジャンプ拡散モデルが活躍します。

### 4.13 さらなる読み物

極限定理に関するより専門的な文献としては、Probability Theoryの古典的な教科書や、応用分野ごとのモノグラフが挙げられます。特に時系列解析や数理ファイナンス、情報理論では、それぞれの文脈に合わせた極限定理のバリエーションが研究されています。

---
### 3.9 ブラウン運動との関係

ブラウン運動は分散が有限な場合の極限定理の結果として得られる連続時間過程です。粒子のランダムな運動や金融商品の価格変動を記述する基本モデルとなっており、確率微分方程式の理論と深く結びついています。安定過程はブラウン運動の一般化とみなすこともできます。

### 3.10 ネットワークトラフィックモデリング

通信ネットワークで観測されるトラフィックは自己相似的な振る舞いを示すことが知られており、安定分布や重い裾をもつモデルが有効とされます。こうした現象を説明するために、安定分布への極限理論が利用されます。

### 4.14 実装上のポイント

極限定理を利用したシミュレーションや統計計算では、乱数生成の品質やサンプルサイズの選択が結果に大きく影響します。特に重い裾をもつ分布を扱う場合は、極端値に対するロバストな処理が必要です。実装時には数値誤差の蓄積やアルゴリズムの収束条件にも注意しましょう。

---
### 4.15 統計ソフトウェアでの活用

RやPythonの統計ライブラリでは、中心極限定理やポアソン近似を前提とした関数が数多く提供されています。実際にデータ分析を行う際には、これらの関数がどのような仮定に基づいているかを理解しておくと、結果の解釈が容易になります。

### 5.1 次に学ぶべきトピック

極限定理を理解したあとは、推定理論や検定理論、さらには統計的学習理論へと進むことが一般的です。極限定理がどのように応用されているかを追うことで、統計学の全体像が見えてくるでしょう。
### 5.2 参考文献

- W. Feller, *An Introduction to Probability Theory and Its Applications*
- P. Billingsley, *Probability and Measure*
- G. Grimmett & D. Stirzaker, *Probability and Random Processes*
- M. Loeve, *Probability Theory*

これらの文献には極限定理に関する詳細な証明や応用例が豊富に載っており、さらなる学習に役立ちます。

さらなる探究としては、依存確率変数に対する極限定理や、測度論的確率論からみた厳密な定式化を学ぶと理解が深まります。特にマルチンゲール収束定理や大偏差原理との関連を押さえることで、より幅広い応用に対応できるようになります。

---

この章では大数の法則から安定分布まで幅広く取り上げましたが、実際の応用ではここで述べた定理以外にも多くのバリエーションがあります。例えば、独立性を弱めたミキシング列に対する極限定理、再生核ヒルベルト空間を用いた非線形変換後の極限定理など、最先端の研究は多岐にわたります。読者の興味に応じて、専門書や論文を参照しながら理解を深めてみてください。

以上で極限定理の章を終えます。次章では統計的推測の基礎を学び、これらの理論が実際のデータ解析でどのように生きるかを具体的に見ていきましょう。

---

## 付録：重要な不等式

極限定理の証明には、マルコフの不等式、チェビシェフの不等式、ホルダーの不等式など、さまざまな解析的手法が利用されます。これらの不等式は確率変数の振る舞いを評価するうえで欠かせない道具です。証明を深く理解したい場合は、これらの不等式の導出にも目を通しておくと良いでしょう。

# 1.1.2 確率空間の定義と公理

## はじめに — 確率とは？

**確率** とは、「ある事象が起こる可能性」を数値で表したものです。初心者の方は、まずイメージしやすい例から考えてみましょう。

- **サイコロ**  
  サイコロを1回振って「1の目が出る」確率は  
  $$
  \frac{1}{6} \approx 0.167 \quad (\text{約16.7\%})
  $$
  また、「偶数の目が出る」確率は  
  $$
  \frac{3}{6} \;=\; \frac{1}{2} \;=\; 0.5 \quad (\text{50\%})
  $$

- **コイン投げ**  
  公平なコインを投げて「表」が出る確率は  
  $$
  \frac{1}{2} \;=\; 0.5 \quad (\text{50\%})
  $$

- **天気予報**  
  「明日、雨が降る確率」は気象条件により、10%の日もあれば90%の日もあるでしょう。

確率のとりうる値は $0$ から $1$ の間です。たとえば、

- $0$: 絶対に起こらない事象
- $1$: 必ず起こる事象
- $0 < p < 1$: 起こる「可能性の度合い」

このような「可能性」をより厳密に扱うために、数学の枠組みとして **確率空間** を導入します。  
さらに、この概念を知ると「確率」の仕組みを論理的に理解でき、統計学や機械学習といった応用分野でも役立ちます。

---

## 確率空間とは？

確率を体系的・再現性をもって取り扱うには、「**確率空間**」という構造を定義します。これは次の3つの要素からなります。

1. **標本空間** $\Omega$  
2. **事象の集合** $F$（$\sigma$-代数）  
3. **確率測度** $P$

### 1. 標本空間 $\Omega$

ある実験や観測で「起こりうるすべての結果」を集めた集合を **標本空間** と呼びます。

- **サイコロ**  
  $$
  \Omega = \{\,1,2,3,4,5,6\,\}.
  $$
- **コインを2回投げる**  
  $$
  \Omega = \{\,
    (\text{表},\text{表}),
    (\text{表},\text{裏}),
    (\text{裏},\text{表}),
    (\text{裏},\text{裏})
  \,\}.
  $$
- **トランプから1枚引く**  
  $$
  \Omega = \{\,\text{全52枚のカード}\}.
  $$

ほかにも、「ある日の気温」を考えると、$\Omega$ は「取りうる温度の値の集合（たとえば実数全体など）」になるかもしれません。  
要は「実験・観測で取りうるあらゆる結果」を **1つの集合** としてまとめたものが標本空間です。

### 2. 事象の集合 $F$（$\sigma$-代数）

「事象 (Event)」とは、標本空間 $\Omega$ の**部分集合**のこと。  
たとえばサイコロの場合、「偶数の目が出る」も「3以下の目が出る」も、それぞれ $\Omega$ の部分集合です。

ただし、何でもかんでも「部分集合」に確率を割り当てるのは難しい場合があります。そこで、**確率を割り当てたい事象たち**だけを集めた「集合の集合」を $F$ とし、以下の条件（$\sigma$-代数）を満たすようにします。

1. 空集合 $\varnothing$ が含まれる  
2. もし $A \in F$ なら、その補集合 $A^c$ も $F$ に含まれる  
3. 可算（無限に数え上げ可能）個の事象の「和集合」$\bigcup_{i=1}^\infty A_i$ が $F$ に含まれる

実用上は、「**自分が興味を持つすべての出来事**（および必要な演算で生成される事象）を含む集合」と思ってください。  
たとえばサイコロやコインの例では、$\Omega$ が有限集合なので、単純に「$\Omega$ のすべての部分集合」を $F$ にしてもOKです。

### 3. 確率測度 $P$

それぞれの事象に対して数値（0〜1）を割り当てる関数が **確率測度** です。  
$$
P \colon F \;\to\; [0,1].
$$
事象 $A \in F$ に対して $P(A)$ を「その事象が起こる確率」と呼びます。  
サイコロなら「$\{\,1\}$ の確率は $1/6$」「$\{\,2,4,6\}$ の確率は $3/6$」などと設定できます。

---

## コルモゴロフの3公理

ロシアの数学者 **コルモゴロフ** が1933年に提唱した「確率論の基礎」を成す3つの公理は、以下のとおりです。

1. **非負性 (Non-negativity)**  
   すべての事象 $A \in F$ に対して
   $$
   P(A) \;\ge\; 0.
   $$
   負の確率は存在しない、という当然ながら重要なルールです。

2. **正規性 (Normalization)**  
   標本空間 $\Omega$ 全体の確率は1
   $$
   P(\Omega) \;=\; 1.
   $$
   どんな結果であれ必ず「何か」は起こるので、合計が1になるわけです。

3. **可算加法性 (Countable additivity)**  
   互いに排反（同時には起こらない）な事象 $A_1, A_2, \dots$ について
   $$
   P\Bigl(A_1 \cup A_2 \cup \dots \Bigr)
   \;=\;
   P(A_1) \;+\; P(A_2) \;+\; \dots.
   $$
   いわゆる「足し算の法則」です。有限個の場合だけでなく、**無限個**の場合にも成り立つ点がポイントです。

これら3つの公理のおかげで、確率論を矛盾なく構築できるようになっています。  
とてもシンプルに見えますが、この枠組みから期待値や確率分布、さらに高度な大数の法則や中心極限定理などが導かれていくのです。

---

## コルモゴロフの公理から導かれる基本性質

これらの公理により、次のような性質が簡単に証明できます。日常的にもよく使うルールです。

### 空集合の確率は0

$$
P(\varnothing) \;=\; 0.
$$

- 証明（イメージ）  
  $\Omega \cup \varnothing = \Omega$ であり、$\varnothing$ と $\Omega$ は排反。可算加法性より  
  $$
  P(\Omega) \;=\; P(\Omega \cup \varnothing)
  \;=\; P(\Omega) + P(\varnothing)
  \;\Longrightarrow\; P(\varnothing)=0.
  $$

### 確率の上限は1

どんな事象 $A \subseteq \Omega$ に対しても
$$
P(A) \;\le\; 1.
$$

- 理由  
  $A \subseteq \Omega$ なので、単調性（後述）から $P(A) \le P(\Omega) = 1$ となります。

### 補事象の確率

$$
P(A^c) \;=\; 1 \;-\; P(A).
$$

- 証明  
  $A \cup A^c = \Omega$ かつ $A \cap A^c = \varnothing$  
  より  
  $$
  P(A) \;+\; P(A^c) \;=\; P(\Omega) \;=\; 1.
  $$

### 単調性

もし $A \subseteq B$ ならば
$$
P(A) \;\le\; P(B).
$$

- $A$ が小さい集合であるほど、起こりうる結果が限定されるため、確率も大きくはならないわけです。

### 加法定理（一般形）

2つの事象 $A, B$ について
$$
P(A \cup B)
\;=\;
P(A) \;+\; P(B) \;-\; P(A \cap B).
$$

- これは「重複している部分（$A \cap B$）を1回だけ引く」というルールで、排反事象のときには $A\cap B=\varnothing$ なので単純な足し算だけになります。

これらの基本性質は、本当に確率の「お約束」なので、覚えておくと問題を解くときに頻出です。

---

## 条件付き確率

### 定義

「事象 $B$ が起きた」という条件の下での「事象 $A$ が起きる確率」を **条件付き確率** と呼び、次式で定義します。

$$
P(A \mid B)
\;=\;
\frac{P(A \cap B)}{P(B)},
\quad
P(B) \;>\; 0.
$$

これは「すでに $B$ が起こった」とわかったときに、$A$ が起こる可能性はどのくらいか、を示すものです。

### 例：サイコロ

「サイコロを振って、3より大きい（4,5,6）が出たときに偶数（2,4,6）である確率」は？

- 「3より大きい目」$=\{4,5,6\}$  
- 「偶数の目」$=\{2,4,6\}$  
- 両方を満たす $=\{4,6\}$

よって  
$$
P(\text{偶数} \mid \text{3より大きい})
\;=\;
\frac{P(\{4,6\})}{P(\{4,5,6\})}
\;=\;
\frac{2/6}{3/6}
\;=\;
\frac{2}{3}.
$$

### 乗法定理（積の法則）

条件付き確率の定義 $P(A \cap B) = P(B)\,P(A|B)$ を並べ替えると、同時に起こる確率についての **乗法定理** が得られます。

$$
P(A \cap B)
\;=\;
P(A)\,P(B \mid A)
\;=\;
P(B)\,P(A \mid B).
$$

#### $n$個の場合（一般化）

事象 $A_1, A_2, \dots, A_n$ がすべて起こる確率は、条件付き確率を段階的に使って

$$
P(A_1 \cap A_2 \cap \cdots \cap A_n)
=
P(A_1)
\,\times\,
P(A_2 \mid A_1)
\,\times\,
P(A_3 \mid A_1 \cap A_2)
\,\times
\cdots.
$$

**例** : トランプを3枚連続で引いて全部ハートを引く確率  
- 1枚目ハート：$\dfrac{13}{52}$  
- 2枚目ハート（1枚目がハートとわかっている条件下）：$\dfrac{12}{51}$  
- 3枚目ハート（1,2枚目がハートとわかっている条件下）：$\dfrac{11}{50}$  

よって  
$$
P(\text{3枚ともハート})
=
\frac{13}{52}
\,\times\,
\frac{12}{51}
\,\times\,
\frac{11}{50}
\;\approx\; 0.0266 \;(\text{約2.66\%}).
$$

---

## 独立事象

2つの事象 $A, B$ が **独立** であるとは、一方が起こる・起こらないが他方の確率に影響しないことを意味します。数学的には

$$
P(A \cap B) \;=\; P(A)\,P(B)
$$

が成り立つとき、$A$ と $B$ は独立と言います。これは

$$
P(A \mid B) \;=\; P(A),
\quad
P(B \mid A) \;=\; P(B)
$$

と同値です。

### 例

- **サイコロを2回振る**：1回目の結果と2回目の結果  
- **公平なコインを複数回投げる**：各回の結果（表/裏）  
- **血液型とIQ**：通常は無関係とされる  

### 相互独立

$n$個の事象 $A_1,\dots,A_n$ が **相互独立** であるとは、どの部分集合を取り出してきても、その交わりの確率が積で表せることです。  
- たとえば3つの事象 $A_1,A_2,A_3$ なら、2つずつだけでなく3つ同時の交わり  
  $$
  P(A_1 \cap A_2 \cap A_3)
  \;=\;
  P(A_1) \,P(A_2) \,P(A_3)
  $$
  も成り立つ必要があります。

---

## 全確率の定理

標本空間 $\Omega$ を「互いに排反かつ和集合が$\Omega$」になるような事象 $B_1,\dots,B_n$ で分割したとき、任意の事象 $A$ について

$$
P(A)
=
P(A \mid B_1)\,P(B_1)
\;+\;
P(A \mid B_2)\,P(B_2)
\;+\;
\cdots
\;+\;
P(A \mid B_n)\,P(B_n).
$$

これは「分割して考える→足し合わせる」という非常に便利な公式です。

### 例：病気と検査

- 病気 $D$ の発生率: $P(D)=0.01$（1%）  
- 病気の人が検査で陽性になる確率: $P(T\mid D)=0.95$（95%）  
- 健康な人が誤って陽性になる確率: $P(T\mid D^c)=0.05$（5%）

ここで、$\{D, D^c\}$ は排反かつ $D \cup D^c = \Omega$。  
検査が陽性となる確率 $P(T)$ は全確率の定理により

$$
P(T)
=
P(T\mid D)\,P(D)
\;+\;
P(T\mid D^c)\,P(D^c).
$$

具体的には  
$$
P(D^c) = 1 - P(D) = 0.99,
$$
よって  
$$
P(T)
=
0.95 \times 0.01
\;+\;
0.05 \times 0.99
=
0.0095 + 0.0495
=
0.059
\quad (\text{5.9\%}).
$$

---

## ベイズの定理

**ベイズの定理** は、条件付き確率を「逆方向」に求める際に用いる公式です。

$$
P(B \mid A)
=
\frac{P(A \mid B)\,P(B)}{P(A)}.
$$

また、全確率の定理と組み合わせると

$$
P(B_i \mid A)
=
\frac{
  P(A \mid B_i)\,P(B_i)
}{
  \sum_{j=1}^n P(A \mid B_j)\,P(B_j)
}.
$$

### 例：病気と検査（事後確率）

先ほどの病気の例で、「検査が陽性 ($T$) だったときに実際に病気 ($D$) である確率」は？

$$
P(D \mid T)
=
\frac{P(T \mid D)\,P(D)}{P(T)}
=
\frac{\,0.95 \times 0.01\,}{0.059}
\approx 0.161
\quad(\text{16.1\%}).
$$

検査精度は95%と高めですが、病気の事前確率（1%）が低いと、**「陽性」だからといって病気とは限らない** という典型例です。  
これは「base rate fallacy（事前確率の無視）」としてしばしば話題になります。

---

## 排反事象と加法定理（和の法則）

### 排反事象

2つの事象 $A$ と $B$ が **排反 (mutually exclusive)** であるとは、

$$
A \cap B \;=\; \varnothing
$$

すなわち同時には絶対起こらないことです。

- 例  
  - サイコロの目が「2」と「3」  
  - コイン投げで「表」と「裏」  
  - サッカーの試合で「Aチームが勝つ」と「Aチームが引き分ける」（同時には成り立たない）

### 加法定理（和の法則）

2つの事象 $A, B$ について
$$
P(A \cup B)
=
P(A) + P(B) - P(A \cap B).
$$

特に、$A$ と $B$ が排反なら $P(A \cap B)=0$ なので
$$
P(A \cup B)
=
P(A) + P(B).
$$

#### 包除原理 — $n$個の事象

3つの事象 $A, B, C$ の場合は
$$
P(A \cup B \cup C)
=
P(A) + P(B) + P(C)
- P(A \cap B) - P(A \cap C) - P(B \cap C)
+ P(A \cap B \cap C).
$$

より一般に、$n$個の事象の和集合の確率を求めるときは、**包除原理** (Inclusion-Exclusion principle) を使います。  
これは組合せ論や論理学にも現れる重要な考え方です。

---

## まとめと次のステップ

- **コルモゴロフの3公理**  
  現代確率論の土台。非負性・正規性・可算加法性。
- **可算加法性**  
  排反事象の確率は足し合わせられる。無限個の場合にも拡張できる。
- **条件付き確率と乗法定理**  
  一方の事象が起こるとわかっているときや、複数の事象が同時に起こる確率を求める基礎。
- **全確率の定理**  
  標本空間を分割して確率を合成するときに便利。病気と検査の例などが代表例。
- **ベイズの定理**  
  条件付き確率を「逆向き」に計算する強力な道具。事後確率を求める場面で頻出。
- **排反事象と加法定理**  
  確率の「足し算」の基本原則。包除原理まで拡張される。

これらを理解することで、サイコロやコイン投げといった離散的な例から、連続分布の概念（確率変数・期待値・分布関数など）へと自然に進むことができます。

初心者の方は、まずはここに挙げた公式や定義を使って **具体的な数値例** をたくさん計算してみましょう。サイコロやコインの例で **「条件が変わると確率がどう変わるか」** を実感するのが大切です。また、「検査が陽性でも病気である確率が意外に低い」など、日常生活にもつながる話題なので、モチベーションが保ちやすいでしょう。

さらに先へ進むと、**確率変数 (random variable)** や **期待値 (expectation)**、**確率分布 (probability distribution)** といった概念を扱うようになり、より高度な統計・解析へ応用できます。大数の法則や中心極限定理など、確率論がもつパワフルな定理に触れると、世界の見方が一段と広がるでしょう。

いま学んだ「**確率空間とコルモゴロフの公理**」は、すべての基礎となる重要な土台です。ぜひ繰り返し参照して、しっかり理解を深めてください。

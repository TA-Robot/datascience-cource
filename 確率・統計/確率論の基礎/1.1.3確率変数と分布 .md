# 1.1.3 確率変数と分布

---

## はじめに

ここでは **「確率変数 (Random Variable)」** という概念と、それに伴う **「確率分布」** のいろいろな表現方法について学びます。  
前章（[1.1.2 確率空間の定義と公理](#)）では、「事象」という集合論的な枠組みを使って確率を定義する方法を学びました。しかし、多くの場合は「数値」に着目したい、つまり「実験の結果を数値で表現したい」ことが多いですよね。

たとえば、
- サイコロを振ったときに出る「目の数」：1,2,3,4,5,6 といった数値
- 人の身長、体重、成績：実数値
- 金融商品の価格変動：時系列の実数値

そうした **「結果を数値として扱う」** ために、確率空間 $(\Omega, F, P)$ から実数への写像を導入します。それが **確率変数** です。  

さらに確率変数を通じて、「確率変数がどの値をとりうるか・どの値をとる可能性が高いか」などを表す関数として **確率分布**（PMF, PDF, CDF）が登場します。本章ではそれらの定義や性質、そして離散型・連続型だけでなく **混合型** の場合もカバーしていきます。


---


## 1. **確率変数 (Random Variable)** の定義

### 1.1 確率変数とは何か？

**確率変数** とは、確率空間 $(\Omega, F, P)$ 上で定義された、**実数への写像**（関数）$X:\Omega \to \mathbb{R}$ のことです。  

直感的には、実験の結果（$\Omega$ の要素）を受けて、**1つの数値** を割り当てる仕組みだと思ってください。  
- 「サイコロを振る」実験では、$\Omega = \{1,2,3,4,5,6\}$ とし、それぞれの $\omega \in \Omega$ に対応して $X(\omega) = \omega$（つまり目の出方）という関数を考える。  
- 「コイン投げ2回」の実験では、$\Omega = \{(\text{表},\text{表}), (\text{表},\text{裏}), (\text{裏},\text{表}), (\text{裏},\text{裏})\}$。そこで、$X(\omega)$ を「表が出た回数」と定義すると、取りうる値は $\{0,1,2\}$ になります。  

このように「実験結果そのものは集合の要素」として定義しつつ、それを **数値化** するわけです。

### 1.2 可測性の条件

確率変数 $X$ が単なる「写像」で終わらないようにするために、$X$ は「$\sigma$-代数 $F$ と Borel $\sigma$-代数 $\mathcal{B}(\mathbb{R})$」の間で **可測** であることを要求します。  
- 具体的には「$X^{-1}(B) \in F$ を満たすようにする」  
- $B$ は実数軸上の任意の Borel集合（開区間など）  

これを満たさないと、確率空間上で「$X$ がある値をとる確率」などが定義できなくなるからです。  
ただし、サイコロやコインのように有限または可算な場合は、ほとんど問題なく可測性が成り立ちます。連続的な場合も、普通の関数であれば可測性を満たすことが多いです。  
高校生レベルでは「**普通に考えられる数値関数なら確率変数と思ってOK**」くらいの理解で問題ないでしょう。

### 1.3 「確率変数」という名前の由来

「変数」と聞くと $x$ という文字を想像するかもしれませんが、実は「変数」というよりも「関数の出力」という方が正しいかもしれません。  
ただ歴史的経緯などで「確率変数 (Random Variable)」という名前になっており、「$\omega$ という不確定な実験結果に対して $X(\omega)$ という数値が割り当てられる」ため、結果が予測できない＝ランダムな変数、というイメージです。

---

## 2. **離散型確率変数** と **確率質量関数 (PMF)**

### 2.1 離散型とは？

**離散型確率変数** とは、その確率変数が取りうる値の集合（値域）が、高々可算（有限もしくは可算無限）な場合をいいます。  
- 例: $\{0,1,2,3,\dots\}$ のように整数のみをとる確率変数  
- 例: $\{1,2,3,4,5,6\}$ のように有限な値しかとらないサイコロの目  

要するに「とびとびの値」しかとらない確率変数ということです。

### 2.2 PMF（確率質量関数）の定義

離散型確率変数 $X$ に対して、$X$ の具体的な値を $x$ とするときに  
$$
p_X(x)
\;=\;
P\bigl(X = x\bigr)
$$
という関数を **確率質量関数 (PMF; Probability Mass Function)** と呼びます。

PMF は以下のような性質を持ちます。

1. $p_X(x) \ge 0$  
2. $\sum_{x} p_X(x) = 1$  （$x$ は $X$ が取りうる全ての値を走る）

#### なぜ “mass (質量)” か？

確率を「重み」あるいは「質量」として扱う比喩から来ています。値 $x$ の位置に「質量」$p_X(x)$ が乗っているイメージです。  
実際、確率論では離散型の場合「質点分布」と呼ばれることもあります。

### 2.3 例：サイコロ

- 確率変数 $X(\omega) = \omega$ で、$\Omega=\{1,2,3,4,5,6\}$  
- 公平なサイコロなら $P(X = x) = \frac{1}{6}$ for $x=1,\dots,6$

これを PMF で書くと  
$$
p_X(x)
=
\begin{cases}
\frac{1}{6} & x \in \{1,2,3,4,5,6\}, \\
0 & \text{otherwise}.
\end{cases}
$$

### 2.4 例：ベルヌーイ分布

- ある実験が「成功 (1) / 失敗 (0)」のみをとる。成功確率が $p$  
- このときの確率変数 $X$ は $\{0,1\}$ のみをとる。

$$
p_X(x)
=
\begin{cases}
p & x=1,\\
1-p & x=0,\\
0 & \text{その他}.
\end{cases}
$$

これは **Bernoulli分布** と呼ばれ、試行が1回しかない場合の極シンプルな分布ですが、後に出てくる **二項分布** の土台になります。

### 2.5 例：二項分布

- ベルヌーイ試行を $n$ 回独立に行い、成功数を $X$ とするとき  
- $X$ は $\{0,1,2,\dots,n\}$ をとり、その確率は  
  $$
  p_X(k)
  =
  P(X = k)
  =
  \binom{n}{k} p^k (1-p)^{n-k},\quad k=0,1,\dots,n.
  $$

これを **二項分布** といいます。受験数学でもよく登場する基本的な分布ですね。

### 2.6 離散型分布の可視化例

- $p_X(x)$ を **棒グラフ** や **プロット** で示す  
- $x$ 軸に取りうる値、$y$ 軸に確率質量 $p_X(x)$

たとえば二項分布 $n=5, p=0.3$ の場合、$k=0,\dots,5$ に対しての $p_X(k)$ を計算し、棒グラフを描くと「$k=1$ や $k=2$ 辺りがいちばん確率が高い」といった様子が見えます。

---

## 3. **連続型確率変数** と **確率密度関数 (PDF)**

### 3.1 連続型とは？

一方、**連続型確率変数** とは、値を **連続的に**（実数の区間など）取りうる確率変数のことです。  
- 例: 「身長」「体重」「温度」「時間」など、ある区間内のどこかしらの値をとる  
- もちろん厳密には離散化された測定しかできませんが、理論上「実数値」で扱うほうが自然にモデル化しやすいのです。  

連続型の場合、$P(X = a)$ のように「特定の1点をとる確率」は **通常 0** となります。離散型とは扱い方が変わってきます。

### 3.2 CDF から見る連続型

確率変数 $X$ の **累積分布関数 (CDF; Cumulative Distribution Function)** は
$$
F_X(x)
=
P\bigl(X \le x\bigr)
$$
で定義される関数でした（離散型/連続型問わず定義できる）。  
連続型の場合、この $F_X(x)$ は「連続的に変化する」ことが多く、さらに **微分** が存在するときには「確率密度関数 (PDF)」で表すことが可能です。

### 3.3 PDF（確率密度関数）の定義

連続型確率変数 $X$ において、  
$$
f_X(x)
=
\frac{d}{dx}F_X(x)
\quad
(\text{導関数が存在するとき})
$$
を **確率密度関数 (PDF; Probability Density Function)** と呼びます。

さらに、$f_X(x)$ は以下の性質を満たします。  
1. $f_X(x) \ge 0$ （どこでも負にはならない）  
2. 区間全体で積分すると1になる  
   $$
   \int_{-\infty}^{\infty} f_X(x)\,dx = 1.
   $$

#### 累積分布関数との関係

$$
F_X(x)
=
\int_{-\infty}^{x} f_X(t)\,dt.
$$

「**確率密度関数を積分すると確率になる**」というのが連続型の基本的な考え方です。  
また **“密度”** と呼ばれるのは「ある微小区間 $[x, x+dx]$ における確率」を $f_X(x)\,dx$ と近似できるというイメージです。

### 3.4 例：一様分布

区間 $[0,1]$ のどこでも同じ確率密度を持つ確率変数 $X$ は、**一様分布** と呼ばれます。

- PDF:
  $$
  f_X(x)
  =
  \begin{cases}
  1 & 0 \le x \le 1, \\
  0 & \text{それ以外}.
  \end{cases}
  $$
- ちゃんと積分すると
  $$
  \int_0^1 1\,dx = 1,
  $$
  となるので確率密度関数の条件を満たします。

### 3.5 例：正規分布

**正規分布 (Normal Distribution)** は、統計・機械学習・自然科学などあらゆる分野で特に重要な分布です。  
平均 $\mu$、分散 $\sigma^2$ の正規分布 $N(\mu,\sigma^2)$ の PDF は

$$
f_X(x)
=
\frac{1}{\sqrt{2\pi}\,\sigma}
\exp\!\Bigl(-\frac{(x-\mu)^2}{2\sigma^2}\Bigr),
\quad
-\infty < x < \infty.
$$

- 釣鐘型のなめらかな曲線  
- 中心極限定理により「多くの独立な要因の和の分布は正規分布に近づく」など、その汎用性は群を抜いています。

### 3.6 「どこか1点をとる確率」は 0

連続型確率変数では「$P(X=a)$」のように特定の1点をとる確率は0になります。  
- たとえば $P(X=0.5)$ を計算すると、積分範囲が「点」なので $\int_{0.5}^{0.5} f_X(x)\, dx = 0$.  
- これは離散型との大きな違い。離散型では $p_X(k)$ が正になることがあるのに対し、連続型では1点に対しては確率がなく、「区間」で確率を捉えます。

---

## 4. **CDF（累積分布関数）** の性質

離散型・連続型・混合型を含め、**すべての確率変数** に定義できるのが累積分布関数 (CDF) です。  
$$
F_X(x)
=
P\bigl(X \le x\bigr).
$$

CDF には以下のような基本的な性質があります。

1. **右連続**  
   $$
   \lim_{h \to 0^+} F_X(x + h) = F_X(x).
   $$

2. **単調非減少**  
   $x_1 < x_2$ ならば $F_X(x_1) \le F_X(x_2)$.  
   （大きい値のところの確率のほうが大きいか同じ）

3. **両端の極限**  
   $$
   \lim_{x \to -\infty} F_X(x) = 0,
   \quad
   \lim_{x \to \infty} F_X(x) = 1.
   $$

#### 例：離散型の CDF

サイコロの例: $P(X \le x)$ をプロットすると、ステップ状の関数になります。  
- $x<1$ なら $P(X \le x)=0$  
- $1 \le x<2$ なら $P(X \le x)=1/6$  
- $2 \le x<3$ なら $P(X \le x)=2/6$  
- …  
- $6 \le x$ なら $P(X \le x)=1$

#### 例：連続型の CDF

一様分布 $U(0,1)$ の例:  
$$
F_X(x)
=
\begin{cases}
0 & x<0,\\
x & 0 \le x \le 1,\\
1 & x>1.
\end{cases}
$$

真ん中の $0 \le x \le 1$ の区間では、傾き1の直線になっています。

### CDF は汎用的

PMF や PDF は「離散型／連続型／混合型」で別々に扱いますが、**CDF だけはどんな場合でも定義できる** という利点があります。このおかげで、確率論や数理統計の一般的な議論では CDF が重要な役割を果たします。

---

## 5. 変数変換と分布の導出

### 5.1 単射変換（1対1変換）の基本

確率変数 $X$ を何らかの関数 $g$ で変換して新しい確率変数 $Y = g(X)$ を定義したい場合があります。  
たとえば、
- $Y = 2X + 3$  
- $Y = e^X$  
- $Y = X^2$ など

特に関数 $g$ が **単射（1対1）** で、逆関数 $g^{-1}$ が存在する場合、$Y$ の分布関数や密度を簡単に計算できます。

### 5.2 離散型の場合の変数変換

離散型では $Y=g(X)$ が取りうる値の列挙で PMF を求められます。  
- $p_Y(y) = P(Y = y) = P(g(X) = y) = \sum_{x : g(x)=y} p_X(x).$  
- もし $g$ が 1対1 なら $x$ が一意に決まるので $p_Y(y) = p_X(g^{-1}(y))$ となります。

#### 例：$Y = X+1$（サイコロの目を +1 する）

- $X$ は $\{1,2,3,4,5,6\}$ をそれぞれ $1/6$ の確率でとる  
- $Y = X+1$ は $\{2,3,4,5,6,7\}$ をそれぞれ $1/6$ の確率でとる  
- よって $p_Y(y) = 1/6$ if $y \in \{2,\dots,7\}$, それ以外は 0

### 5.3 連続型の場合の変数変換（Jacobian）

連続型では「密度関数を使って変換先の分布を求める」やり方があります。  
単射変換 $Y = g(X)$ で微分可能かつ $g'(x)\neq 0$ などの条件があれば、**Jacobian** を使って PDF を求められます。

#### 定理（1変数の場合）

$$
f_Y(y)
=
f_X\bigl(g^{-1}(y)\bigr)\;
\left|\frac{d}{dy}g^{-1}(y)\right|.
$$

あるいは、$y = g(x)$ と書くと

$$
f_Y(y)
=
f_X(x)\;
\bigl|\! \frac{dx}{dy} \bigr|
\quad
\text{（ただし } y=g(x)\text{）}.
$$

これが「変数変換の公式」です。2変数・多変数の場合は行列式（Jacobian行列）に置き換わります。

#### 例：$Y = aX + b$

- $Y = aX + b$, $a\neq 0$  
- 逆関数 $X = \frac{Y - b}{a}$  
- $f_Y(y) = f_X\left(\frac{y - b}{a}\right)\;\frac{1}{|a|}$  
- 応用例：正規分布 $N(\mu,\sigma^2)$ を標準正規分布に変換するなど。

#### 例：$Y = X^2$（$X$ は正の値のみをとると仮定）

- $X = \sqrt{Y}$ が逆関数  
- $\frac{d}{dy}\sqrt{Y} = \frac{1}{2\sqrt{Y}}$  
- よって
  $$
  f_Y(y)
  =
  f_X(\sqrt{y})
  \;\times\;
  \left|\frac{1}{2\sqrt{y}}\right|
  \quad (\text{ドメイン }y \ge 0).
  $$

変数変換は統計学や信号処理、機械学習などで頻繁に現れるテクニックです。最初は少しややこしいかもしれませんが、段階を追って覚えていくと良いでしょう。

---

## 6. **混合型確率変数**

### 6.1 混合型とは？

確率変数の中には、「ある確率で離散値をとり、残りの確率で連続的に分布する」ような **混合型** が存在します。  
- 例: 「確率 $p$ で 0 をとり、確率 $1-p$ で $U(0,1)$ に従う」  
- 例: 「建物の階数はほぼ 1階,2階,3階… などの離散値だが、建物がない（0階？）というイベントもあるかもしれない。あるいは '地下' という概念をどう扱うか…」等々、実際の現象では純粋に離散か連続か分からない場合もある。

### 6.2 分布関数から見る

混合型を表すには、「離散部分」と「連続部分」の両方を組み合わせて確率分布を記述します。  
CDF $F_X(x)$ はジャンプ（不連続点）がある部分が離散成分を表し、なめらかな増加部分が連続成分を表すイメージです。

- 離散部分の寄与:  
  $$
  P(X = x_0)
  =
  F_X(x_0) - \lim_{\varepsilon \to 0^-}F_X(x_0 + \varepsilon).
  $$
  ジャンプの大きさがその点の確率質量になる。
- 連続部分の寄与:  
  ジャンプ以外の区間での微分として PDF が存在。

### 6.3 例：0 を点質量として持つ指数分布

$$
P(X = 0) = p,
\quad
X>0 \text{ のときには指数分布}(\lambda) \text{に従う（確率 } 1-p).
$$

- CDF は
  $$
  F_X(x)
  =
  \begin{cases}
  0 & x<0,\\[6pt]
  p & x=0,\\[6pt]
  p + (1-p)\bigl(1-e^{-\lambda x}\bigr) & x>0.
  \end{cases}
  $$
- PDF (連続部分のみ) は
  $$
  f_X(x)
  =
  \begin{cases}
  0 & x<0,\\
  (1-p)\,\lambda\,e^{-\lambda x} & x>0.
  \end{cases}
  $$

このように「ある点に確率質量がある」＋「連続部分がある」形を混合型と呼びます。

---

## 7. まとめ

ここまで「**確率変数とその分布**」について、離散型・連続型・混合型と幅広く学びました。振り返りとして要点を整理しておきましょう。

1. **確率変数 (Random Variable)**  
   - 確率空間 $(\Omega, F, P)$ から実数 $\mathbb{R}$ への可測関数  
   - 実験結果を「数値」で表すために導入

2. **離散型 (Discrete)**  
   - 値域が高々可算な確率変数  
   - PMF (確率質量関数) $p_X(x) = P(X=x)$ で表される  
   - $\sum_{x} p_X(x) = 1$  
   - 代表例：ベルヌーイ、二項、ポアソン など

3. **連続型 (Continuous)**  
   - 値域が連続的な確率変数  
   - PDF (確率密度関数) $f_X(x)$ と CDF $F_X(x)$ で表される  
   - $\int_{-\infty}^{\infty} f_X(x)\,dx = 1$  
   - 1点の確率は0  
   - 代表例：正規、一様、指数、ガンマ、ベータ など

4. **CDF (累積分布関数)**  
   - どんな確率変数でも $F_X(x)=P(X\le x)$ で定義できる  
   - 右連続・単調非減少・両端極限などの性質をもつ  
   - 離散/連続/混合 全部を包含できる万能な表現

5. **変数変換**  
   - $Y=g(X)$ における $Y$ の分布を求めるには、PMF/PDF/CDF の変換を行う  
   - 単射変換なら Jacobian を用いた公式で簡便に求まる

6. **混合型**  
   - 離散的な部分と連続的な部分をあわせもつ分布  
   - CDF でジャンプ（点質量）+連続部分という形で表現される

---

## 8. 高校生にもわかりやすい練習問題

最後に、理解を深めるためにいくつか練習問題を用意します。高校生レベルの範囲で解けるようなものから少し拡張的なものまで、段階的に挑戦してみてください。

### 練習問題1: サイコロの PMF

- サイコロを1回振る実験を考える。  
- 確率変数 $X$ を「出た目」とする。  
1. $X$ は離散型か連続型か？  
2. $p_X(x)$ を求めよ。  
3. CDF $F_X(x) = P(X \le x)$ を求め、ステップ状のグラフを描いてみよう。

### 練習問題2: コイン投げ回数と二項分布

- 公平なコインを3回投げ、表が出た回数を $Y$ とする。  
1. $Y$ の取りうる値は何か？  
2. PMF $p_Y(k)$ を求めよ。  
3. $k$ の期待値 $E[Y]$ と分散 $\mathrm{Var}(Y)$ を計算しよう（次章の期待値の定義を参照してみてもよい）。

### 練習問題3: 一様分布の CDF と確率計算

- $X \sim U(0,2)$（区間[0,2]での一様分布）とする。  
1. PDF $f_X(x)$ と CDF $F_X(x)$ を書け。  
2. $P(0.5 \le X \le 1.5)$ を計算せよ。  
3. $P(X = 1)$ はいくらか？ なぜそうなるか解釈せよ。

### 練習問題4: 変数変換（連続型）

- ある確率変数 $X$ の分布がわかっており、$Y = 3X + 2$ という新しい変数を定義した。  
1. $Y$ の CDF を、$X$ の CDF $F_X(x)$ を用いて表せ。  
2. $X$ が PDF $f_X(x)$ を持つと仮定し、$f_Y(y)$ を求めよ。  
   （Jacobian 公式を使う）

### 練習問題5: 混合分布

- $P(X = 0) = 0.3$ で、$X$ が 0.3 の確率で値 0 をとり、その他の 0.7 の確率で区間 $(0,1)$ に一様分布するとする。  
1. $X$ は離散型・連続型・混合型のどれに該当するか？  
2. CDF を書け。  
3. 「$X=0$ である確率」と「$X>0$ の任意の区間での確率」の両方が整合することを確認せよ。

---

## 9. さらに学ぶためのヒント

- **確率変数と収束**  
  確率変数の列 $X_n$ が $X$ に収束する、という概念もあります。たとえば **確率収束**、**ほぼ確実収束**、**$L^p$ 収束** など、いくつかのタイプがあり、測度論的な観点で定義されます。興味があれば先の章で学んでみましょう。  

- **モーメントとモーメント母関数**  
  次章（[1.1.4 期待値・モーメント・共分散](#)）で扱いますが、確率変数の「平均」や「分散」などの数値要約は重要です。PMF や PDF が具体的にわからなくても、期待値や分散を通じて重要な情報を得ることができます。

- **特性関数 (Characteristic Function)**  
  PDF が存在しないような怪しい分布（たとえばコーシー分布）でも、「特性関数」は常に存在します。特性関数は確率論における強力なツールの1つで、大数の法則や中心極限定理の証明などにも活躍します。

- **積分と測度論**  
  連続分布の理論的厳密さを追求すると、ルベーグ積分や測度論が基礎となります。大学以降の確率論では、確率変数や分布を測度論的に扱うことが主流です。

- **応用分野**  
  - 統計学: さまざまな分布の母集団を想定して推定や検定を行う  
  - 機械学習: 確率モデル（ガウス過程、混合ガウスモデル etc.）  
  - 信号処理: 雑音がガウス分布と仮定されることが多い  
  - 金融工学: 株価モデル（例: Geometric Brownian Motion）など、連続時間確率モデル  

「確率変数」という考え方は、これら多くの分野での数学的な土台となっています。ぜひしっかり理解を深めつつ、多彩な分野への応用をイメージしてみてください。

---

## 10. 超ざっくりまとめ

1. **確率変数**  
   - 実験結果を数値化する「関数」  
   - 離散 / 連続 / 混合 … いろいろなタイプがある

2. **PMF (離散)**  
   - $p_X(x)=P(X=x)$  
   - $\sum_x p_X(x)=1$

3. **PDF (連続)**  
   - $f_X(x) \ge 0,\;\int f_X(x)dx =1$  
   - 1点の確率は0

4. **CDF**  
   - すべての確率変数で定義可  
   - 右連続、単調非減少、両端で 0 と 1

5. **変数変換**  
   - 単射なら Jacobian 公式で密度変換が簡単

6. **混合型**  
   - 点質量 + 連続部分が両方ある

これらを踏まえて、次の「期待値・モーメント・共分散」の章で、確率変数の「平均」や「散らばり」を学んでいきましょう。そこから先の統計学・機械学習にも深くつながる、確率論のメインストリームがはじまります。
